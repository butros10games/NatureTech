{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="stylesheet" href="{% static 'css/boer-admin/orders/admin_orders.css' %}" />
  </head>
  <body>
    <table id="booking-table">
      <thead>
        <tr>
          <th>Order Nummer</th>
          <th>Naam</th>
          <th>CheckIn datum</th>
          <th>CheckOut datum</th>
          <th>Kinderen</th>
          <th>Volwasssenen</th>
          <th>PDF</th>
          <th>Ingecheckt</th>
          <th>Betaald</th>
          <th>Telefoon nummer</th>
          <th>Email</th>
        </tr>
      </thead>
      <tbody id="table_content">
        {% for booking in page_obj %}
          <tr>
            <td>{{ booking.order_number }}</td>
            <td>{{ booking.customer.user.first_name }} {{ booking.customer.user.last_name }}</td>
            <td>{{ booking.start_date }}</td>
            <td>{{ booking.end_date }}</td>
            <td>{{ booking.age_below }}</td>
            <td>{{ booking.age_above }}</td>
            <td>{{ booking.pdf }}</td>
            <td>{{ booking.checked_in }}</td>
            <td>{{ booking.paid }}</td>
            <td>{{ booking.customer.phone_number }}</td>
            <td>{{ booking.customer.user.email }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
    <div class="pagination">
      <span class="step-links">
        {% if page_obj.has_previous %}
          <a href="?page=1">&laquo; first</a>
          <a href="?page={{ page_obj.previous_page_number }}" class="ajax-link">Vorige</a>
        {% endif %}
      </span>

      <span class="current">{{ page_obj.number }} / {{ page_obj.paginator.num_pages }}.</span>

      <span class="step-links">
        {% if page_obj.has_next %}
          <a href="?page={{ page_obj.next_page_number }}" class="ajax-link">Volgende</a>
        {% endif %}
      </span>
    </div>
  </body>

  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script>
    $(document).ready(function () {
      // Function to attach event listeners to pagination links
      function attachEventListeners() {
        // Intercept clicks on pagination links with the 'ajax-link' class
        $('.ajax-link').on('click', function (e) {
          e.preventDefault()
          var url = $(this).attr('href')
          loadTable(url)
        })
      }
    
      // Function to load the table content via AJAX
      function loadTable(url) {
        $.ajax({
          url: url,
          type: 'GET',
          success: function (data) {
            $('#booking-table').html(data)
            history.pushState({}, '', url)
    
            // Reattach event listeners after updating the HTML content
            attachEventListeners()
          },
          error: function (data) {
            console.log('Error:', data)
          }
        })
      }
    
      // Attach initial event listeners
      attachEventListeners()
    })
  </script>
</html>
